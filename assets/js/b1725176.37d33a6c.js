"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[142],{1396:(e,n,c)=>{c.r(n),c.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>a});var o=c(4848),t=c(8453);const r={sidebar_position:2},s="UI Block",l={id:"common/uiblock",title:"UI Block",description:"UI blocks are a powerful tool for describing and interacting with user interface elements. They allow you to define UI elements within the context of their parent blocks, rather than the entire screen, which makes tests more readable, maintainable, and reliable.",source:"@site/docs/common/uiblock.md",sourceDirName:"common",slug:"/common/uiblock",permalink:"/ultron/docs/common/uiblock",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Allure",permalink:"/ultron/docs/common/allure"},next:{title:"UltronTest",permalink:"/ultron/docs/common/ultrontest"}},i={},a=[{value:"Compose",id:"compose",level:2},{value:"Compose Multiplatform",id:"compose-multiplatform",level:3},{value:"Compose Android Only",id:"compose-android-only",level:3},{value:"Espresso",id:"espresso",level:2},{value:"Espresso Web",id:"espresso-web",level:2},{value:"UiAutomator",id:"uiautomator",level:2}];function d(e){const n={br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"ui-block",children:"UI Block"}),"\n",(0,o.jsx)(n.p,{children:"UI blocks are a powerful tool for describing and interacting with user interface elements. They allow you to define UI elements within the context of their parent blocks, rather than the entire screen, which makes tests more readable, maintainable, and reliable."}),"\n",(0,o.jsx)(n.p,{children:"For example, consider a UI block that represents a user\u2019s name and status. We can define this block once and reuse it across different screens."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"UI Block",src:c(4112).A+"",width:"668",height:"174"})}),"\n",(0,o.jsx)(n.p,{children:"We can describe this block and use it on different screens."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.em,{children:"Supported: Compose (CMP & Android), Espresso, Espresso Web, UiAutomator (UiObject2)"})}),"\n",(0,o.jsx)(n.h2,{id:"compose",children:"Compose"}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsxs)(n.p,{children:["Create a class that inherits from ",(0,o.jsx)(n.code,{children:"UltronComposeUiBlock"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:"\nclass ContactCard(blockMatcher: SemanticsMatcher, blockDescription: String) \n    : UltronComposeUiBlock(blockMatcher, blockDescription) {\n    val name = child(hasTestTag(contactNameTag)).withName(\"Name in '$blockDescription'\")\n    val status = child(hasTestTag(contactStatusTag))\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"UltronComposeUiBlock"})," accepts two parameters:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"blockMatcher"})," \u2013 describes how to locate this block in the Compose element tree. This is a required parameter and must always be provided."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"blockDescription"})," \u2013 a description of the block that clearly identifies the UI container. This parameter is optional, with a default value of ",(0,o.jsx)(n.code,{children:'blockDescription = ""'}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Note"}),": To describe child elements of a UI block, you need to use the ",(0,o.jsx)(n.code,{children:"child()"})," method."]}),"\n",(0,o.jsxs)(n.p,{children:["As shown in the example above, we added a custom name to the ",(0,o.jsx)(n.code,{children:"name"})," field. If an error occurs, this name will appear in the description of the element we tried to interact with. We recommend including the value of ",(0,o.jsx)(n.code,{children:"blockDescription"})," in the element description. This provides better context about the specific element being checked (or any other operation performed)."]}),"\n",(0,o.jsx)(n.p,{children:"The next step is to integrate the block into a screen."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:'object SomeComposeScreen : Screen<SomeComposeScreen>(){\n    val card = ContactCard(hasTestTag(contactCardTag), "SomeComposeScreen contact card")\n    \n    fun assertContactCard(contact: Contact){\n        softAssertion {\n            card.name.assertTextEquals(contact.name)\n            card.status.assertTextEquals(contact.status)\n        }\n    }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["As seen in ",(0,o.jsx)(n.code,{children:"SomeComposeScreen"}),", we no longer need to know how to locate ",(0,o.jsx)(n.code,{children:"name"})," and ",(0,o.jsx)(n.code,{children:"status"}),". It's enough to describe how to locate the parent UI block \u2013 ",(0,o.jsx)(n.code,{children:"ContactCard"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["In addition to individual UI elements, child blocks can also represent other UI blocks. To describe a child UI block, you can use one of the overloaded ",(0,o.jsx)(n.code,{children:"child"})," methods."]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"In Multiplatform, only the method requiring an explicit approach to creating the child block is available."}),"\n",(0,o.jsx)(n.li,{children:"In Android, you can simplify this further using reflection."}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"compose-multiplatform",children:"Compose Multiplatform"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:"class ProfileBlock(blockMatcher: SemanticsMatcher, blockDescription: String) \n    : UltronComposeUiBlock(blockMatcher, blockDescription) {\n    val card = child(\n        childMatcher = hasTestTag(contactCardTag),\n        uiBlockFactory = { updatedMatcher ->\n            ContactCard(\n                blockMatcher = updatedMatcher, \n                blockDescription = \"Contact card '$blockDescription'\"\n            )\n        }\n    )\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["This method offers greater flexibility for creating child UI blocks.",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.code,{children:"updatedMatcher"})," \u2013 an updated matcher used to locate the ",(0,o.jsx)(n.code,{children:"ContactCard"})," only within the ",(0,o.jsx)(n.code,{children:"ProfileBlock"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"compose-android-only",children:"Compose Android Only"}),"\n",(0,o.jsx)(n.p,{children:"Reflection capabilities in Android are more advanced than in Multiplatform, allowing for simpler descriptions of child UI blocks."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:"class ProfileBlock(blockMatcher: SemanticsMatcher, blockDescription: String) \n    : UltronComposeUiBlock(blockMatcher, blockDescription) {\n    val card = child(\n        ContactCard(\n            blockMatcher = hasTestTag(contactCardTag), \n            blockDescription = \"Contact card '$blockDescription'\"\n        )\n    )\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"There are limitations to using this method:"}),"\n",(0,o.jsx)(n.p,{children:"The class must meet the following conditions to be instantiated:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"It must not be a nested or inner class. It should be defined at the top level or as a file-level class."}),"\n",(0,o.jsxs)(n.li,{children:["It must have one of the following constructors:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["A constructor with one parameter of type ",(0,o.jsx)(n.em,{children:"SemanticsMatcher"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["A constructor with two parameters: ",(0,o.jsx)(n.code,{children:"blockMatcher"})," of type ",(0,o.jsx)(n.em,{children:"SemanticsMatcher"})," and ",(0,o.jsx)(n.code,{children:"blockDescription"})," of type ",(0,o.jsx)(n.em,{children:"String"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["We can use the ",(0,o.jsx)(n.code,{children:"ProfileBlock"})," on the screen."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:'object SomeComposeScreen : Screen<SomeComposeScreen>(){\n    val profile = ProfileBlock(hasTestTag(profileTag), "SomeComposeScreen profile card")\n    \n    fun assertContactCardInProfile(contact: Contact){\n        softAssertion {\n            profile.card.name.assertTextEquals(contact.name)\n            profile.card.status.assertTextEquals(contact.status)\n        }\n    }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"UltronComposeUiBlock"})," class has a ",(0,o.jsx)(n.code,{children:"uiBlock"})," property, which facilitates proper interaction with block elements."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:'object SomeComposeScreen : Screen<SomeComposeScreen>(){\n    val profile = ProfileBlock(hasTestTag(profileTag), "SomeComposeScreen profile block")\n    \n    fun assertProfileContactIsDisplayed(){\n        profile.card.uiBlock.assertIsDisplayed()\n    }\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"espresso",children:"Espresso"}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsxs)(n.p,{children:["Create a class that inherits from ",(0,o.jsx)(n.code,{children:"UltronEspressoUiBlock"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:"class ContactCard(blockMatcher: Matcher<View>, blockDescription: String) \n    : UltronEspressoUiBlock(blockMatcher, blockDescription) {\n    val name = child(withId(R.id.name)).withName(\"Name in '$blockDescription'\")\n    val status = child(withId(R.id.name))\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"Add the block to the screen."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:'object SomeEspressoScreen : Screen<SomeEspressoScreen>(){\n    val card = ContactCard(withId(R.id.card), "SomeComposeScreen contact card")\n    \n    fun assertContactCard(contact: Contact){\n        softAssertion {\n            card.name.hasText(contact.name)\n            card.status.hasText(contact.status)\n        }\n    }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Using reflection simplifies the implementation of child UI blocks by automating instantiation under specific conditions."}),"\n",(0,o.jsx)(n.p,{children:"Child UI block with reflection."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:"class ProfileBlock(blockMatcher: Matcher<View>, blockDescription: String) \n    : UltronEspressoUiBlock(blockMatcher, blockDescription) {\n    val card = child(\n        ContactCard(\n            blockMatcher = withId(R.id.contactCard), \n            blockDescription = \"Contact card of '$blockDescription'\"\n        )\n    )\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"Child UI block with factory method"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:"class ProfileBlock(blockMatcher: Matcher<View>, blockDescription: String) \n    : UltronEspressoUiBlock(blockMatcher, blockDescription) {\n    val card = child(\n        childMatcher = withId(R.id.contactCard),\n        uiBlockFactory = { updatedMatcher ->\n            ContactCard(\n                blockMatcher = updatedMatcher, \n                blockDescription = \"Contact card '$blockDescription'\"\n            )\n        }\n    )\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"Define block on screen"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:'object SomeEspressoScreen : Screen<SomeEspressoScreen>(){\n    val profile = ProfileBlock(withId(R.id.profileBlock), "SomeEspressoScreen profile block")\n    \n    fun assertContactCardInProfile(contact: Contact){\n        softAssertion {\n            profile.uiBlock.isDisplayed()\n            profile.card.uiBlock.isDisplayed()\n            profile.card.name.hasText(contact.name)\n            profile.card.status.hasText(contact.status)\n        }\n    }\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"espresso-web",children:"Espresso Web"}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsxs)(n.p,{children:["Create a class that inherits from ",(0,o.jsx)(n.code,{children:"UltronWebElementUiBlock"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:'class WebContactCard(blockElement: UltronWebElement, blockDescription: String)\n    : UltronWebElementUiBlock(blockElement, blockDescription){\n    val name = child(id("name")).withName("Name in \'$blockDescription\'")\n    val status = child(className("status"))\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Add the block to the screen."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:'object SomeWebScreen : Screen<SomeWebScreen>(){\n    val card = WebContactCard(id("card"), "SomeWebScreen contact card")\n    \n    fun assertContactCard(contact: Contact){\n        softAssertion {\n            card.name.hasText(contact.name)\n            card.status.hasText(contact.status)\n        }\n    }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Child UI block with reflection"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:'class WebProfileBlock(blockMatcher: UltronWebElement, blockDescription: String) \n    : UltronWebElementUiBlock(blockMatcher, blockDescription) {\n    val card = child(\n        WebContactCard(\n            blockElement = id("card"), \n            blockDescription = "Contact card of \'$blockDescription\'"\n        )\n    )\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Child UI block with factory method"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:'class WebProfileBlock(blockMatcher: UltronWebElement, blockDescription: String) \n    : UltronWebElementUiBlock(blockMatcher, blockDescription) {\n    val card = child(\n        childMatcher = id("card"),\n        uiBlockFactory = { updatedElement ->\n            ContactCard(\n                blockElement = updatedElement, \n                blockDescription = "Contact card \'$blockDescription\'"\n            )\n        }\n    )\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"uiautomator",children:"UiAutomator"}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsxs)(n.p,{children:["Only ",(0,o.jsx)(n.strong,{children:"UiObject2"})," is supported."]}),"\n",(0,o.jsxs)(n.p,{children:["Create a class that inherits from ",(0,o.jsx)(n.code,{children:"UltronUiObject2UiBlock"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:'class UiAutomatorContactCard(blockDesc: String, blockSelector: () -> BySelector)\n    : UltronUiObject2UiBlock(blockDesc, blockSelector){\n    val name = child(bySelector(R.id.name)).withName("Name in \'$blockDesc\'")\n    val status = child(By.desc("status content desc"))\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Add the block to the screen."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:'object SomeUiAutomatorScreen : Screen<SomeUiAutomatorScreen>(){\n    val card = UiAutomatorContactCard(\n       blockDesc="SomeUiAutomatorScreen contact card",\n       blockSelector=bySelector(R.id.card)\n    )\n    \n    fun assertContactCard(contact: Contact){\n        softAssertion {\n            card.name.hasText(contact.name)\n            card.status.hasText(contact.status)\n        }\n    }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Child UI block with reflection"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:"class UiAutomatorProfileBlock(blockDesc: String, blockSelector: () -> BySelector)\n   : UltronUiObject2UiBlock(blockDesc, blockSelector){\n    val card = child(\n        UiAutomatorContactCard(\n            blockDesc = \"Contact card of '$blockDesc'\",\n            blockSelector = { bySelector(R.id.card) }\n        )\n    )\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"Child UI block with factory method"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-kotlin",children:"class UiAutomatorProfileBlock(blockDesc: String, blockSelector: () -> BySelector)\n   : UltronUiObject2UiBlock(blockDesc, blockSelector){\n    val card = child(\n        selector = bySelector(R.id.card),\n        description = \"Contact card of '$desc'\",\n        uiBlockFactory = { desc, selector ->\n            UiAutomatorContactCard(desc, selector)\n        }\n    )\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},4112:(e,n,c)=>{c.d(n,{A:()=>o});const o=c.p+"assets/images/uiblock-6c9a62477a32b6ad168570e267edc6d5.png"},8453:(e,n,c)=>{c.d(n,{R:()=>s,x:()=>l});var o=c(6540);const t={},r=o.createContext(t);function s(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);