"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[374],{7280:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var n=o(4848),i=o(8453);const r={sidebar_position:5},a="withSuitableRoot",s={id:"android/rootview",title:"withSuitableRoot",description:"Method allows to avoiding nontrivial element lookup exceptions",source:"@site/docs/android/rootview.md",sourceDirName:"android",slug:"/android/rootview",permalink:"/ultron/docs/android/rootview",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"UI Automator",permalink:"/ultron/docs/android/uiautomator"},next:{title:"Test Conditions Management",permalink:"/ultron/docs/android/testconditions"}},l={},c=[];function d(e){const t={code:"code",h1:"h1",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"withsuitableroot",children:"withSuitableRoot"}),"\n",(0,n.jsx)(t.p,{children:"Method allows to avoiding nontrivial element lookup exceptions"}),"\n",(0,n.jsx)(t.p,{children:"In some cases, we encounter non-trivial exceptions in finding elements that are part of the Espresso framework. Such problems and their solution will be considered."}),"\n",(0,n.jsx)(t.h1,{id:"waited-for-the-root-of-the-view-hierarchy-to-have-window-focus-and-not-request-layout-for-10-seconds",children:"Waited for the root of the view hierarchy to have window focus and not request layout for 10 seconds."}),"\n",(0,n.jsx)(t.p,{children:"If you observe such an exception, then this indicates a complex problem for testing the user interface. One of the well-known reasons is that programmers add their views to the application context, and not to the activity or fragment. At phase of view interaction creation, Espresso assigns a root view where your matcher will be matched. Unfortunately, the views attached to the application context may not have the same root view that was set at the time view interaction was created. To solve this problem, the following solution was created:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-kotlin",children:"val toolbarTitle = withId(R.id.toolbar_title)\n\nfun assertToolbarTitleWithSuitableRoot(text: String) {\n    toolbarTitle.withSuitableRoot().hasText(text)\n}\n"})}),"\n",(0,n.jsx)(t.p,{children:"withSuitableRoot() extension returns a view interaction with the correct root view in which the element you are looking for will be  located. If the root view is not found, the test will be interrupted with espresso exception - NoMatchingRootException: Matcher ...did not match any of the following roots..."}),"\n",(0,n.jsx)(t.p,{children:"You can also use the root matcher to set the root for Espresso view interaction."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-kotlin",children:"val toolbarTitle = withId(R.id.toolbar_title)\nonView(toolbarTitle).inRoot(withSuitableRoot(toolbarTitle)).check {\n    // Your checks here\n}\n"})}),"\n",(0,n.jsx)(t.p,{children:"The same works for UltronRecyclerViewItem:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-kotlin",children:"val recycler = withRecyclerView(R.id.recycler_friends)\n\nclass FriendRecyclerItem : UltronRecyclerViewItem() {\n    val name by child { withId(R.id.tv_name) }\n    val status by child { withId(R.id.tv_status) }\n    val avatar by child { withId(R.id.avatar) }\n}\n\nfun getListItem(positions: Int): FriendRecyclerItem {\n    return recycler.getItem(positions)\n}\n\n// Usage:\n\ngetListItem(0).withSuitableRoot().isDisplayed()\ngetListItem(0).name.withSuitableRoot().isDisplayed().click()\n"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,t,o)=>{o.d(t,{R:()=>a,x:()=>s});var n=o(6540);const i={},r=n.createContext(i);function a(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);